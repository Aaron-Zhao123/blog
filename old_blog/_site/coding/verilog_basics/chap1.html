<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Aaron's Wiki by </title>

    <link rel="stylesheet" href="/assets/css/style.css?v=">
    <meta name="viewport" content="width=device-width">
    <script src='//cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js'></script>
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Aaron's Wiki</h1>
        <!-- <p>Hello, thanks for visiting my personal wiki.</p> -->
        <!-- <h2>Projects</h2> -->
        <p class="view"><a href="blog/index">main page</a></p>
        <p class="view"><a href="blog/projects/projects_sum.html">Projects</a></p>
        <p class="view"><a href="blog/papers/papers_index.html">Paper Reviews</a></p>
        <p class="view"><a href="blog/books/books_index.html">Book Reviews</a></p>
        <p class="view"><a href="blog/coding/coding_index.html">Coding and APIs</a></p>
        <p class="view"><a href="blog/posts/posts_index.html">Posts</a></p>
        <!-- <p class="view"><a href="/index">main page</a></p>
        <p class="view"><a href="/projects/projects_sum.html">Projects</a></p>
        <p class="view"><a href="/papers/papers_index.html">Paper Reviews</a></p>
        <p class="view"><a href="/books/books_index.html">Book Reviews</a></p>
        <p class="view"><a href="/coding/coding_index.html">Coding and APIs</a></p>
        <p class="view"><a href="/posts/posts_index.html">Posts</a></p> -->
        <!-- <p class="view"><a href="/blog/papers/nn_models/model_summary.html">Papers</a></p> -->
        <!-- <h2>Book and Code Reviews</h2> -->
        <!-- <p class="view"><a href="">Books</a></p>
        <p class="view"><a href="">Python</a></p>
        <p class="view"><a href="">C++</a></p> -->
        <!-- <h2>Contacts</h2> -->
        

        

        
      </header>
      <section>

      <h1 id="chapter-1-finite-state-machines">Chapter 1: Finite State Machines</h1>
<p>FSMs are normally broken down into two parts: the first part is transactional logic and the second part is state-dependent logic.
A combinational logic is in charge of both computing the next state and output signal depending on the current state.
In Verilog, this is a achieved using <strong>two always blocks</strong>, one clocked always block to compute the next state and one without a clock to compute the output.</p>

<p>The FSM states are <strong>one-hot coded</strong>, more state registers, for N states, we have N flip flops.
However, the state transitions are a lot easier because no logic is required to decode.</p>

<p>Blocking and non-blocking assignments.
Use blocking assignments in <strong>always_ff</strong> and non-blocking assignmetns in <strong>always</strong>.</p>

<p>Using <strong>enum</strong> to define statesâ€™ encoding.</p>
<pre><code class="language-Verilog">module FSM(
  clk,
  async_reset,
  enable,
  s_in,
  s_out
  );
  input wire clk, async_reset, enable;
  input wire s_in;
  output wire s_out;
  reg s_out;
  reg [3:0] state;
  // if using enum
  typedef enum {IDLE=4'b0001, STATE1 = 4'b0010, STATE2 = 4'b0100, END = 4'b1000} States;
  // if using parameter keyword
  parameter IDLE = 2'b00, READ = 2'b01, DLY  = 2'b11, DONE = 2'b10;

  always @ (posedge clk or posedge async_reset) begin
    if (async_reset) begin
      state &lt;= 4'b0001;
    end
    else begin
      if (enable) begin
        if (state == 4'b0001 &amp;&amp; s_in == 1'b1) begin
          state &lt;= 4'b0010;
        end
        if (state == 4'b0010 &amp;&amp; s_in == 1'b0) begin
          state &lt;= 4'b0001;
        end
        if (state == 4'b0010 &amp;&amp; s_in == 1'b1) begin
          state &lt;= 4'b1000;
        end
        if (state == 4'b1000 &amp;&amp; s_in == 1'b0) begin
          state &lt;= 4'b0100;
        end
        if (state == 4'b0100 &amp;&amp; s_in == 1'b0) begin
          state &lt;= 4'b0001;
        end
        if (state == 4'b0010 &amp;&amp; s_in == 1'b1) begin
          state &lt;= 4'b1000;
        end
      end
    end
  end

  always @ (*) begin
    case (state)
      2'b00: s_out = 0;
      2'b01: s_out = 0;
      2'b11: s_out = 1;
      2'b10: s_out = 1;
    endcase
  end

endmodule
</code></pre>


      </section>
      <footer>
        
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="/assets/js/scale.fix.js"></script>


  
  </body>
</html>
